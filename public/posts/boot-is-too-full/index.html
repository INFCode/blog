<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Fix &#34;Partition /boot is too full&#34; Error on Linux | Infcode&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Saving Space on Your /boot Partition
I recently ran into trouble because I followed the old advice of allocating only ~200MB for the /boot partition. While this might have been a reasonable choice a decade ago, when files were smaller and disk space was more expensive, it’s no longer sufficient for modern systems. On top of that, I’m dual-booting with Windows, which further complicates disk space management.
Anyway, that&rsquo;s the situation I faced. The next question was: how do I fix this? After searching online, I found several recommendations that suggested deleting initramfs-linux-fallback.img to free up space. While it’s a large file and might seem unnecessary, it’s not advisable to remove it without understanding its purpose.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/boot-is-too-full/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/boot-is-too-full/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fix &#34;Partition /boot is too full&#34; Error on Linux</title>

  
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['$', '$']]                  
    }
  };
</script>
  

  
</head>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Infcode&#39;s Blog (Alt + H)">Infcode&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Fix &#34;Partition /boot is too full&#34; Error on Linux
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2024-05-22 22:53:35 -0400 EDT'>May 22, 2024</span>

</div>
  </header> 
  <div class="post-content"><h2 id="saving-space-on-your-boot-partition">Saving Space on Your /boot Partition<a hidden class="anchor" aria-hidden="true" href="#saving-space-on-your-boot-partition">#</a></h2>
<p>I recently ran into trouble because I followed the old advice of allocating only ~200MB for the <code>/boot</code> partition. While this might have been a reasonable choice a decade ago, when files were smaller and disk space was more expensive, it’s no longer sufficient for modern systems. On top of that, I’m dual-booting with Windows, which further complicates disk space management.</p>
<p>Anyway, that&rsquo;s the situation I faced. The next question was: how do I fix this? After searching online, I found several recommendations that suggested deleting <code>initramfs-linux-fallback.img</code> to free up space. While it’s a large file and might seem unnecessary, it’s not advisable to remove it without understanding its purpose.</p>
<h2 id="why-you-shouldnt-delete-the-fallback-image">Why You Shouldn&rsquo;t Delete the Fallback Image<a hidden class="anchor" aria-hidden="true" href="#why-you-shouldnt-delete-the-fallback-image">#</a></h2>
<p>The <code>initramfs-linux.img</code> file, which is the default boot image, is critical for booting your computer. It contains the necessary kernel modules that tell the OS how to interact with your hardware based on your current setup. In most cases, this file is enough to boot your system.</p>
<p>But what happens when you make hardware changes (e.g., adding new RAM)? Since the <code>initramfs-linux.img</code> only contains the modules needed for the hardware present when it was generated, it might not have the correct modules for your new hardware. This is where the <code>initramfs-linux-fallback.img</code> comes in. The fallback image contains all the kernel modules that Linux supports, allowing the system to handle new or unrecognized hardware. If the fallback image is deleted and your system requires a module not found in the standard <code>initramfs</code>, it may fail to recognize new hardware.</p>
<p>Thus, deleting the fallback image could leave you in a difficult situation if your system relies on modules that are only available in that file.</p>
<h2 id="compress-instead-of-delete">Compress Instead of Delete<a hidden class="anchor" aria-hidden="true" href="#compress-instead-of-delete">#</a></h2>
<p>Rather than deleting the fallback image, a better solution is to compress it to save space. The <code>mkinitcpio</code> tool makes this easy to do. Here’s how:</p>
<h3 id="1-edit-etcmkinitcpioconf">1. Edit <code>/etc/mkinitcpio.conf</code><a hidden class="anchor" aria-hidden="true" href="#1-edit-etcmkinitcpioconf">#</a></h3>
<p>By default, the <code>mkinitcpio.conf</code> file already includes a compression setting. To reduce the size of your initramfs images, you can increase the compression level in the <code>COMPRESSION_OPTIONS</code> section. Most compression tools (like <code>gzip</code> and <code>xz</code>) support compression levels from 0 (least compressed) to 9 (most compressed). Check the manual page of the tool you select for the best options. For example, <code>gzip</code> is commonly used, but if you&rsquo;re really pressed for space, <code>xz</code> offers a higher compression ratio.</p>
<h3 id="2-use-high-compression-if-necessary">2. Use High Compression if Necessary<a hidden class="anchor" aria-hidden="true" href="#2-use-high-compression-if-necessary">#</a></h3>
<p>If your <code>/boot</code> partition is very limited, you can try <code>xz</code> with the <code>-9e</code> option for maximum compression. Keep in mind that this is a very slow process — on my laptop, it took over five minutes. If you don&rsquo;t need such extreme compression, you can start with a lower level like <code>-6</code> and adjust upward as needed. Be aware that higher compression levels may increase the time and CPU required to generate initramfs images.</p>
<h3 id="3-consult-the-arch-linux-wiki">3. Consult the Arch Linux Wiki<a hidden class="anchor" aria-hidden="true" href="#3-consult-the-arch-linux-wiki">#</a></h3>
<p>For more detailed documentation on different configuration options, I recommend checking out the <a href="https://wiki.archlinux.org/title/Mkinitcpio">Arch Linux Wiki</a>. It’s a valuable resource even if you’re using a different Linux distribution.</p>
<h3 id="4-test-your-config">4. Test Your Config<a hidden class="anchor" aria-hidden="true" href="#4-test-your-config">#</a></h3>
<p>After making your changes, run <code>sudo mkinitcpio -P</code> to rebuild your initramfs images. This command will regenerate the images for all installed kernels. Make sure the command runs without errors and use <code>du</code> to check the compressed size of the files to ensure they are small enough for your <code>/boot</code> partition.</p>
<h3 id="5-reboot-carefully">5. Reboot Carefully<a hidden class="anchor" aria-hidden="true" href="#5-reboot-carefully">#</a></h3>
<p>Once you&rsquo;re satisfied with the size of your images, you can reboot your system. I recommend performing a reboot to ensure everything works as expected. Be cautious when making these changes because a corrupted <code>initramfs-linux.img</code> can prevent your system from booting. It’s a good idea to have a backup or recovery method in place (such as a live USB) just in case something goes wrong.</p>
<p>Good luck!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Infcode&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
